<!-- views/user/head.ejs -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<header class="fixed-header">
    <button id="sidebarToggle" class="toggle-button">&#9776;</button>

    <div class="user-menu">
        <div class="user-icon" id="userIcon">
            <i class="fas fa-user"></i> <!-- FontAwesome User Icon -->
        </div>

        <!-- Dropdown Menu -->
        <div class="user-dropdown" id="userDropdown">
            <p><strong>ID:</strong> <%= id %></p>
            <p><strong>Name:</strong> <%= name %></p>
        </div>
    </div>
</header>

<div class="sidebar" id="sidebar">
    <ul id="sidebar-options">
        <li><a href="/">Home</a></li>
        <li><a href="/userDashboard/user/dashboard_user">Dashboard</a></li>
        <li><a href="/userDashboard/user/make_auction">Make Auction</a></li>
        <li><a href="/userDashboard/user/See_auction">My Listings</a></li>
        <li><a href="/userDashboard/user/auctions">Place a Bid</a></li>
        <li><a href="/userDashboard/user/bids">Participated Auction</a></li>
        <li><a href="/userDashboard/user/public_bid">View Public Bids</a></li>
        <li><a href="/userDashboard/user/profile">Profile</a></li>
    </ul>

    <!-- Logout button container -->
    <div class="logout-container">
        <form class="logout-form" action="/userDashboard/logout" method="POST">
            <button type="submit">Logout</button>
        </form>
    </div>
</div>

<div id="user-info" data-user-id="<%= id %>" style="display: none;"></div>

<!-- Inline JavaScript -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Sidebar toggle functionality
        const sidebarToggle = document.getElementById('sidebarToggle');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');

        sidebarToggle.addEventListener('click', () => {
            const isOpen = sidebar.style.left === '0px';
            sidebar.style.left = isOpen ? '-250px' : '0px';
            if (mainContent) mainContent.style.marginLeft = isOpen ? '0' : '220px';
        });

        // User menu toggle functionality
        const userIcon = document.getElementById('userIcon');
        const userDropdown = document.getElementById('userDropdown');

        userIcon.addEventListener('click', (event) => {
            event.stopPropagation(); // Prevents dropdown from closing immediately
            userDropdown.classList.toggle('active');
        });

        // Hide dropdown when clicking outside
        document.addEventListener('click', (event) => {
            if (!userIcon.contains(event.target) && !userDropdown.contains(event.target)) {
                userDropdown.classList.remove('active');
            }
        });
    });

    // Function to load pages without reloading (AJAX navigation)
    function loadPage(url) {
        fetch(url)
            .then(response => response.text())
            .then(html => {
                document.getElementById("main-content").innerHTML = html; // Load new content
                window.history.pushState({}, "", url); // Update URL without reloading
            })
            .catch(error => console.error("Error loading page:", error));
    }
</script>